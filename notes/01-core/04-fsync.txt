===
Обеспечение записи на диск

Если мы записываем только в файл, отключение питания может привести к исчезновению файла или заполнению его значениями 0x00.
===
Кэш и fsync
- Каждая запись в файл не соответствует напрямую записи на диск. 
- Операционная система имеет кэш в памяти. Записи сначала попадают в кэш, а затем синхронизируются с диском. Это позволяет объединять повторяющиеся записи и повышает пропускную способность. Повторные операции чтения также выигрывают.
- Этот кэш называется страничным кэшем. Страница здесь соответствует странице виртуальной памяти ЦП. Страница — это наименьшая единица ввода-вывода с фиксированным размером (обычно 4 КБ или 16 КБ). 
- Помимо страничного кэша, диски могут также иметь собственный кэш в оперативной памяти. Чтобы гарантировать, что данные достигнут диска, операция должна очистить все слои кэша и дождаться завершения. Это системный вызов fsync в Linux. 
В Windows есть соответствующая операция, поэтому Sync() также применим.

После каждой записи в WAL - fsync файла
В Rust аналог fsync - file.sync_all()
Это добавляется в Log method Write
self.fileptr.sync_all()?;
Теперь запись ушла из page cache и диск подтвердил запись
===
fsync для родительского каталога
В Linux fsync гарантирует запись данных файла, но не гарантирует существование самого файла. Это происходит потому, что файл записывается в родительский каталог. Если запись в каталог добавлена ​​(создание файла), но не записана на диск до отключения питания, файл недоступен, даже если его данные находятся на диске. Чтобы исправить это, вызовите fsync для каталога.
То есть: создание файлов, переименование файлов и удаление файлов требуют использования fsync для содержащего каталога.
Это специфично для Unix. Windows в этом не нуждается.

В проете пишем логику для создания и синхронизайия файла, и исползуем её для создания файла лога
===
Основы Unix
Функция open открывает или создает файл и возвращает число в случае успеха. Это число идентифицирует файл, и используется для последующих операций, таких как fsync. Это число называется дескриптором файла (fd).
Дескриптор файла не ограничивается файлами. Он может ссылаться на другие ресурсы ОС, такие как сетевые сокеты или каталоги. В Unix функция open может открывать каталоги, хотя возвращаемый fd нельзя читать или записывать как файл. Все fd должны быть закрыты.
===
